<!DOCTYPE html>
<html lang="en">
 <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Birthday Paradox - Contrary</title>
    <link href="https://fonts.googleapis.com/css2?family=Cabin+Sketch:wght@400;700&family=Patrick+Hand&family=Architects+Daughter&family=Permanent+Marker&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <link rel="icon" href="{{ url_for('static', filename='assets/favicon.ico') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/birthday.css') }}">
 </head>
 <body>
    <a href="/paradoxes" class="home-link">
        <i data-lucide="arrow-left"></i>
    </a> 
    <div class="game-screen">
        <div class="party-bg"></div>
        <div class="stats-container">
            <div class="music-indicator" id="musicToggle">
                <span id="wrapperSound"><i data-lucide="volume-2"></i></span>
                <span id="wrapperMute" style="display: none;"><i data-lucide="volume-x"></i></span>
            </div>
            <a href="/settings" class="settings-link">
                <i data-lucide="settings"></i>
            </a>
            <div class="stats-panel">
                <h3 class="stats-title">Party Stats</h3>
                <div class="stat-item">
                    <i data-lucide="users"></i>
                    <span>Guests: <strong id="guestCount">0</strong>/100</span>
                </div>
                <div class="stat-item">
                    <i data-lucide="percent"></i>
                    <span>Probability: <strong id="probability">0%</strong></span>
                </div>
                <div class="stat-item">
                    <i data-lucide="zap"></i>
                    <span>Matches: <strong id="matchCount">0</strong></span>
                </div>
            </div>

            <div class="match-panel">
                <div class="probability-meter">
                    <div class="meter-label">Match Chance</div>
                    <div class="meter-bar">
                        <div class="meter-fill" id="meterFill"></div>
                        <div class="meter-50-mark">50%</div>
                    </div>
                </div>
            </div>
            
            <div class="shortcuts-panel">
                <div class="shortcuts-title">Shortcuts</div>
                <div class="shortcut-item">
                    <kbd>Space</kbd>
                    <span>Add Guest</span>
                </div>
                <div class="shortcut-item">
                    <kbd>S</kbd>
                    <span>Show Stats</span>
                </div>
                <div class="shortcut-item">
                    <kbd>R</kbd>
                    <span>Reset Party</span>
                </div>
            </div>

            <button class="stats-button-side" id="statsBtn">
                <i data-lucide="bar-chart-3"></i>
                <span>Show Stats</span>
            </button>
        </div>
        
        <div class="people-area" id="peopleArea"></div>
        <div class="control-buttons" id="controlButtons">
            <button class="game-btn btn-invite" id="inviteBtn" data-label="Add 1 Guest">
                <img src="{{ url_for('static', filename='assets/birthday/button-invite.png') }}" alt="Invite">
            </button>
            <button class="game-btn btn-party" id="partyBtn" data-label="Auto-Add Guests">
                <img src="{{ url_for('static', filename='assets/birthday/button-start-party.png') }}" alt="Party">
            </button>
            <button class="game-btn btn-reset" id="resetBtn" data-label="Reset Everything">
                <img src="{{ url_for('static', filename='assets/birthday/button-reset.png') }}" alt="Reset">
            </button>
        </div>
        <div class="dialogue-box">
            <div class="dialogue-text" id="dialogueText">
                Welcome to the birthday party! Invite guests and watch for matching birthdays. The paradox? You only need 23 people for a 50% chance of a match!
            </div>
        </div>
        <div class="confetti-container" id="confettiContainer"></div>
    </div>
    <div class="custom-modal" id="matchModal">
        <div class="custom-modal-content">
            <h2 class="custom-modal-title">MATCH FOUND!</h2>
            <div class="custom-modal-text" id="matchText"></div>
            <div class="custom-modal-buttons">
                <button class="modal-action-btn btn-ok" id="matchOk">Got it!</button>
            </div>
        </div>
    </div>
    <div class="custom-modal" id="resetModal">
        <div class="custom-modal-content">
            <h2 class="custom-modal-title">Reset Party?</h2>
            <div class="custom-modal-text">This will clear all guests and reset all statistics. Are you sure?</div>
            <div class="custom-modal-buttons">
                <button class="modal-action-btn btn-ok" id="resetConfirm">Yes, Reset!</button>
                <button class="modal-action-btn btn-clear" id="resetCancel">Cancel</button>
            </div>
        </div>
    </div>
    <div class="custom-modal" id="simCompleteModal">
        <div class="custom-modal-content">
            <h2 class="custom-modal-title">Simulation Complete!</h2>
            <div class="custom-modal-text" id="simCompleteText"></div>
            <div class="custom-modal-buttons">
                <button class="modal-action-btn btn-ok" id="simCompleteOk">Awesome!</button>
            </div>
        </div>
    </div>
    <div class="custom-modal" id="newPartyModal">
        <div class="custom-modal-content">
            <h2 class="custom-modal-title">Start New Party?</h2>
            <div class="custom-modal-text">This will reset everything and start fresh. Continue?</div>
            <div class="custom-modal-buttons">
                <button class="modal-action-btn btn-ok" id="newPartyConfirm">Yes, New Party!</button>
                <button class="modal-action-btn btn-clear" id="newPartyCancel">Cancel</button>
            </div>
        </div>
    </div>
    <div class="stats-modal" id="resultsModal">
        <div class="modal-content">
            <h2 class="modal-title">Party Results!</h2>
            <p class="modal-result" id="modalResult"></p>
            <div class="stats-visualization">
                <div class="chart-container">
                    <div class="chart-title">Simulation Statistics</div>
                    <div class="bar-chart">
                        <div class="bar-group">
                            <div class="bar-label">Matches</div>
                            <div class="bar-wrapper">
                                <div class="bar match-bar" id="matchBar">
                                    <span class="bar-percentage" id="matchPercentage">0%</span>
                                </div>
                            </div>
                            <div class="bar-count" id="matchBarCount">0/0</div>
                        </div>
                    </div>
                    <div class="theory-line">
                        <span class="theory-marker">⋯ Expected: ~50.7% at 23 guests</span>
                    </div>
                </div>
            </div>
            <div class="math-explanation">
                <h4>The Birthday Paradox</h4>
                <p>
                    With 23 people, there are 253 possible pairs (23 × 22 ÷ 2). 
                    <br><br>
                    For each pair, the chance they DON'T share a birthday is 364/365.
                    <br><br>
                    For ALL pairs: (364/365)^253 ≈ 49.3% chance of NO matches
                    <br><br>
                    That means ~50.7% chance of AT LEAST ONE match!
                    <br><br>
                    It's counterintuitive because we think "what are the odds someone shares MY birthday" (1/365), 
                    but we should think "what are the odds ANY two people match" (much higher!).
                </p>
            </div>
            <div class="modal-buttons-grid">
                <button class="modal-action-btn btn-play-again-modal" id="modalContinue">
                    Continue Party
                </button>
                <button class="modal-action-btn btn-simulate" id="modalSimulate">
                    Run 100 Sims
                </button>
                <button class="modal-action-btn btn-clear" id="modalReset">
                    New Party
                </button>
            </div>
        </div>
    </div>
    <audio id="bgMusic" loop>
        <source src="{{ url_for('static', filename='assets/music/birthday-music.mp3') }}" type="audio/mpeg">
    </audio>
    <audio id="clickSfx" preload="auto">
        <source src="{{ url_for('static', filename='sfx/click.mp3') }}" type="audio/mpeg">
    </audio>
    <audio id="popSfx" preload="auto">
        <source src="{{ url_for('static', filename='sfx/pop.mp3') }}" type="audio/mpeg">
    </audio>
    <audio id="partyHornSfx" preload="auto">
        <source src="{{ url_for('static', filename='sfx/party-horn.mp3') }}" type="audio/mpeg">
    </audio>
    <audio id="confettiSfx" preload="auto">
        <source src="{{ url_for('static', filename='sfx/confettipop.mp3') }}" type="audio/mpeg">
    </audio>
    <audio id="sweepSfx" preload="auto">
        <source src="{{ url_for('static', filename='sfx/sweep.mp3') }}" type="audio/mpeg">
    </audio>
    <script src="{{ url_for('static', filename='js/birthday.js') }}"></script>
    <script>
        lucide.createIcons();
    </script>
 </body>
</html>
